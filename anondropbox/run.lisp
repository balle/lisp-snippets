;;
;; Loading modules
;;
(ql:quickload "hunchentoot")  ;; webserver
(ql:quickload "djula")        ;; django like templates
(ql:quickload "ironclad")     ;; crypto library


;;
;; Configuration
;;
(load "config.lisp")


;;
;; Templates
;;
(djula:add-template-directory "templates/")
(defvar +index-template+ (djula:compile-template* "index.clt"))


;;
;; Helper functions
;;
(defun generate-id (&optional len)
  (format nil "狺祜镳候屦遽矧戾巢恒镬戾泗黩轸瀛麸篝蜷铉蜥钿镯卑┅┅ㄤ彐躅孱泸痿ㄤ狒岍⑴钽蝙痿翳溽翎鏖翳泔铈殓躜邃疳篌黠蜾躞轭僚英溽翎换韵南屮沐痿轱栳钿扉铉ㄤ彐躅筢鲥礤篌徵躔祜徜哝殪濠⒂狯躔祜徜邃礤篌徵犷浏矧骈戾麸蜥钿镯珏铄蜥翦骈戾轭躔祜徜溟义趱蝾秕麴豸骈戾钺礤鏖翳秕篚骀轼戾è秕暨骈戾钺礤ㄦ矧磲铋狺幄磲脲疳翳钺礤轰轵邈麸蝙躔祜徜溟颡ㄧ孱弪狒瀛殇┅┅ㄩ躔祜徜哝殪鏖翳镳孱骈戾秕ㄦ矧磲铋岙骈戾秕暨骈戾钺礤轰轵邈糸镱猴豸瘐哄戾礤铘豉疱Ж躅箝珙邃怡翦俯鏖翳镳孱骈戾ㄩㄣ狎躔祜徜哝殪濠哄戾礤铘豉疱Ж躅箝珙邃怡翦俯祜镳骘怡翦蝈徜怡翦轭铋у镦躅糸ㄥ怡翦у镦滹黩轸瀛怡翦怡翦秕舂┅┅ㄩ礤篌徵鏖翳镳孱骈戾秕ㄦ矧磲铋岙眢纰秕暨骈戾钺礤轰轵邈糸镱猴豸瘐舂ㄦ矧磲秕狺ア礤篌徵濠┅秕暨骈戾钺礤┅换换找栳钿戾蝮换ㄨ躅汨孱麸雉轰彐轭瀛遽簌栳钿戾ㄩ钿屮乎蜷礤篌徵躔祜徜哝殪濠箦翩ㄨ躅汨孱麸雉恒镱翦铘豉疱Ⅳ屮舣梏盱戾è躔祜徜邃铋飑ㄩ矧礤篌徵躔祜徜哝殪濠箦翩躔祜徜邃筢鲥礤篌徵躔祜徜哝殪濠┅鏖翳秕麴豸麸篝蜷铉篝蝈犴ㄤ牾灬候孱溴颦翦眇灬翦轭溴翦眇灬翦篝蝈犴乎痨镝溴躔祜徜邃┅┅换换篝狒殂骈戾换瘐箬ㄨ躅汨孱麸雉恒蝈狒瀛骘熹弪溟箴狒汨弪犷洵栳钿戾篝狒殂篝狒殂桴钽桢铘镲艉溟箴狒汨翎忪濯换换麽铑溴怩箫礤篝蹑婵换箦翩桴钽桢铘镲艉汜翥璀弪蝻蝮皙铋飑换涕篝孱镱仍孕痫螋换ㄨ躅汨孱麸雉后翎螋磲脲轭篝犷沐ц躅汨孱麸雉哄狍徙沐痿矧吼矧梏麴痫螋┅换涕篝孱镱仍孕痫螋ㄨ躅汨孱麸雉后翎螋磲脲轭篝犷沐ц躅汨孱麸雉哄狍篌飙徙沐痿矧后箪痱轹狒咫妁骈戾篌飙脲骈戾后箪沐螋殒殂狒瀛骈戾篌飙沐螋骈戾吼矧梏麴蟓痫螋轰镢蹴孱舡蝻雉横沣弩蟓祜绛溴篝轭狒轱铋飑